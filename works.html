<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WXZ Studio - 案例作品</title>
    <link rel="stylesheet" href="style.css"> 
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

    <link rel="icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body class="is-light light-theme-nav is-other-page"> 
    
    <div class="nav-wrap">
        <div class="container nav-inner">
            <a href="index.html" class="logo-link">WXZ STUDIO</a>
            
            <nav class="nav-desktop">
                <a href="works.html" class="nav-item is-active">作品</a>
                <a href="about.html" class="nav-item">关于</a>
                <a href="contact.html" class="nav-contact-btn button">联系我们</a>
            </nav>
            <button class="menu-button">菜单</button>
        </div>
    </div>
    
    <div class="mobile-nav" id="mobile-nav">
        <div class="mobile-nav-inner">
            <a href="works.html" class="mobile-nav-item is-active">作品</a>
            <a href="about.html" class="mobile-nav-item">关于</a>
            <a href="contact.html" class="mobile-nav-item">联系我们</a>
        </div>
        <button class="close-button" onclick="closeMobileMenu()">&times;</button>
    </div>
    <div class="nav-overlay" id="nav-overlay"></div>


    <main>
        <section class="section works-page-section">
            <div class="container">
                <h1 class="page-title fade-in">精选视频作品</h1>

                <div class="filter-buttons" id="filter-buttons">
                    <span class="filter-button active" data-tag="all" onclick="filterWorks('all', this)">全部</span>
                </div>

                <div class="works-page-grid" id="works-container">
                    <p id="no-works" style="display: none; text-align: center; grid-column: 1 / -1; color: var(--color-secondary);">未找到符合条件的视频作品。</p>
                </div>
            </div>
        </section>
    </main>
    
    <div id="videoModal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close-button" onclick="closeModal()">&times;</span>
            
            <div class="video-container">
                <video id="videoPlayer" controls preload="metadata" style="width: 100%; height: 100%;"></video>
            </div>
        </div>
    </div>


    <script>
        // **********************************************
        // 核心数据区：请在这里添加/修改您的视频作品信息
        // **********************************************
        const WORKS_DATA = [
            {
                title: "明星侧拍 - 幕后花絮",
                cover: "assets/images/cover_star_bts.jpg", // 封面图路径
                videoUrl: "assets/videos/star_bts_a.mp4", // 视频文件路径
                tags: ["明星侧拍", "幕后花絮", "时尚"]
            },
            {
                title: "美妆产品 - 产品特写",
                cover: "assets/images/cover_product_phone.jpg", // 封面图路径
                videoUrl: "assets/videos/product_phone.mp4", // 视频文件路径
                tags: ["产品拍摄", "科技", "广告片"]
            },
            {
                title: "情绪短片 - 氛围短片",
                cover: "assets/images/cover_fashion_short.jpg", // 封面图路径
                videoUrl: "assets/videos/fashion_short.mp4", // 视频文件路径
                tags: ["时尚", "产品拍摄", "高定"]
            }
            // 您可以添加更多作品对象到这个数组
        ];

        const worksContainer = document.getElementById('works-container');
        const filterButtonsContainer = document.getElementById('filter-buttons');
        const videoModal = document.getElementById('videoModal');
        const videoPlayer = document.getElementById('videoPlayer');
        const noWorksMessage = document.getElementById('no-works');

        // 1. 初始化：生成作品卡片和标签按钮
        function initializeWorks() {
            const allTags = new Set();
            
            worksContainer.innerHTML = ''; // 清空容器
            
            WORKS_DATA.forEach(work => {
                // 收集所有独特的标签
                work.tags.forEach(tag => allTags.add(tag));
                
                // 生成作品卡片HTML
                const item = document.createElement('a'); // 使用 a 标签，语义更好
                item.className = 'work-item video-item'; // 添加 video-item 类名
                // 当点击卡片时，调用 showVideoModal，阻止默认链接行为
                item.setAttribute('onclick', `showVideoModal('${work.videoUrl}', event)`);
                item.href = '#'; // 设置 href 为 #，使其表现得像链接
                
                // 标签 HTML
                const tagsHtml = work.tags.map(tag => `<span class="work-tag">#${tag}</span>`).join('');
                
                item.innerHTML = `
                    <div class="work-cover-wrapper">
                        <div class="work-cover-aspect">
                            <img src="${work.cover}" alt="${work.title} 封面" class="work-cover-img">
                        </div>
                        <span class="play-icon">&#9658;</span> </div>
                    <div class="work-info">
                        <h3 class="work-title">${work.title}</h3>
                        <div class="work-tags">${tagsHtml}</div>
                    </div>
                `;
                worksContainer.appendChild(item);
            });

            // 动态生成标签过滤按钮 (确保只生成一次)
            if (filterButtonsContainer.children.length === 1) { // 检查是否只有“全部”按钮
                allTags.forEach(tag => {
                    const button = document.createElement('span');
                    button.className = 'filter-button';
                    button.innerText = `#${tag}`;
                    button.setAttribute('data-tag', tag);
                    button.setAttribute('onclick', `filterWorks('${tag}', this)`); 
                    filterButtonsContainer.appendChild(button);
                });
            }
        }

        // 2. 过滤逻辑
        window.filterWorks = function(tag, clickedButton) {
            // 移除所有按钮的 active 状态
            document.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
            
            // 设置当前点击按钮为 active
            if (clickedButton) {
                clickedButton.classList.add('active');
            }

            let foundCount = 0;
            
            document.querySelectorAll('.work-item').forEach((item, index) => {
                const work = WORKS_DATA[index];
                
                // 过滤逻辑：如果是 'all' 或 作品标签包含当前标签
                const isVisible = (tag === 'all' || work.tags.includes(tag));

                item.style.display = isVisible ? 'block' : 'none';
                if (isVisible) {
                    foundCount++;
                }
            });

            // 显示/隐藏“未找到”消息
            noWorksMessage.style.display = foundCount === 0 ? 'block' : 'none';
        };


        // 3. Modal 弹窗逻辑
        
        // 显示视频弹窗
        window.showVideoModal = function(videoUrl, event) {
            if (event) {
                event.preventDefault(); // 阻止 a 标签默认跳转
            }

            videoPlayer.src = videoUrl; // 设置视频源
            videoModal.style.display = 'flex'; // 显示弹窗
            document.body.classList.add('no-scroll'); // 防止背景滚动
            
            // 延迟播放以确保 Modal 已完全渲染
            setTimeout(() => {
                videoPlayer.play();
            }, 100);
        };

        // 关闭视频弹窗
        window.closeModal = function() {
            videoPlayer.pause(); // 暂停播放
            videoPlayer.removeAttribute('src'); // 移除源，防止后台播放
            videoModal.style.display = 'none'; // 隐藏弹窗
            document.body.classList.remove('no-scroll'); // 恢复背景滚动
        };
        
        // 键盘 Esc 键关闭
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && videoModal.style.display === 'flex') {
                closeModal();
            }
        });

        // 页面加载完成时初始化
        document.addEventListener('DOMContentLoaded', () => {
            initializeWorks(); // 渲染作品和标签
            // 确保其他页面的 JS 逻辑，如菜单开关，仍然可用
            if (typeof window.initAnimations === 'function') {
                window.initAnimations();
            }
            if (typeof window.initSlidingText === 'function') {
                window.initSlidingText();
            }
        });
    </script>
</body>
</html>